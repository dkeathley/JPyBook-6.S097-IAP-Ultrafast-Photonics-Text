

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Chapter 3 – Nonlinear Pulse Propagation &#8212; 6.S097 Ultrafast Photonics (IAP 2023)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=927b94d3fcb96560df09"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"undefined": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "VBoxModel", "state": {"_view_name": "ErrorWidgetView", "error": {}, "msg": "Model class 'VBoxModel' from module '@jupyter-widgets/controls' is loaded but can not be instantiated"}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter-3';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapter 4 – Mode-Locking" href="chapter-4.html" />
    <link rel="prev" title="Chapter 2 – Pulse Interactions with Linear Media" href="chapter-2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    6.S097 – Ultrafast Photonics (IAP 2025)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter-1.html">Chapter 1 – Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-2.html">Chapter 2 – Pulse Interactions with Linear Media</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 3 – Nonlinear Pulse Propagation</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-4.html">Chapter 4 – Mode-Locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-5.html">Chapter 5 – Dispersion Management and Pulse Characterization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="fourier-transform-resources.html">Fourier Transforms</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/dkeathley/JPyBook-6.S097-IAP2023-Ultrafast-Photonics/blob/main/chapter-3.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/dkeathley/JPyBook-6.S097-IAP2023-Ultrafast-Photonics" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/dkeathley/JPyBook-6.S097-IAP2023-Ultrafast-Photonics/issues/new?title=Issue%20on%20page%20%2Fchapter-3.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chapter-3.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 3 – Nonlinear Pulse Propagation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#materials-and-notes">Materials and Notes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-and-computation">Simulation and Computation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#packages-functions-and-variables-run-first">Packages, Functions and Variables – Run First!</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#self-phase-modulation">Self-Phase Modulation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#soliton-formation">Soliton Formation</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-from-an-initial-gaussian-pulse">Starting from an initial Gaussian pulse</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-from-a-flat-top-pulse">Starting from a “flat-top” pulse</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#influence-of-dispersion-on-supercontinuum-generation">Influence of Dispersion on Supercontinuum Generation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zero-dispersion">Zero Dispersion</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#postive-second-order-dispersion">Postive Second-Order Dispersion</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#considering-k-neq-0-when-k-0">Considering <span class="math notranslate nohighlight">\(k''' \neq 0\)</span> when <span class="math notranslate nohighlight">\(k'' = 0\)</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-3-in-sub-wavelength-structures-all-optical-switching"><span class="math notranslate nohighlight">\(\chi^{(3)}\)</span> in sub-wavelength structures: all optical switching</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-3-nonlinear-pulse-propagation">
<h1>Chapter 3 – Nonlinear Pulse Propagation<a class="headerlink" href="#chapter-3-nonlinear-pulse-propagation" title="Permalink to this heading">#</a></h1>
<p>In this chapter, we will discuss:</p>
<ol class="arabic simple">
<li><p>Self-phase modulation (Lectures 4 and 5)</p>
<ol class="arabic simple">
<li><p>Soliton formation and evolution</p></li>
<li><p>Supercontinuum generation</p></li>
<li><p>Examples in current literature</p>
<ol class="arabic simple">
<li><p>Accounting for higher-order dispersion</p></li>
<li><p>Spectral properties of importance in real-world situations</p></li>
</ol>
</li>
</ol>
</li>
<li><p>Nanophotonics example: a nonlinear switch (Lecture 5)</p>
<ol class="arabic simple">
<li><p>EM field simulations in a sub-wavelength structure with <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span></p></li>
<li><p>Link back to the Fabry-Perot cavity</p></li>
<li><p>Recent progress in the literature</p></li>
</ol>
</li>
</ol>
<section id="materials-and-notes">
<h2>Materials and Notes<a class="headerlink" href="#materials-and-notes" title="Permalink to this heading">#</a></h2>
<p>See Ch. 3 of <a class="reference external" href="https://ocw.mit.edu/courses/6-977-ultrafast-optics-spring-2005/f806ff596f9bffb74003360e2c05c086_MIT6_977S05_textbook.pdf">Ultrafast Optics text from Franz Kaertner</a>.</p>
<p>Class materials (lecture notes, video, etc) are in the <a class="reference external" href="https://drive.google.com/drive/folders/1e_wWXTe0qq07iGwNd2XDNMVTkzv2_cp-?usp=sharing">shared drive</a>.</p>
</section>
<section id="simulation-and-computation">
<h2>Simulation and Computation<a class="headerlink" href="#simulation-and-computation" title="Permalink to this heading">#</a></h2>
<p>Simulation and computational examples for this chapter follow.</p>
<section id="packages-functions-and-variables-run-first">
<h3>Packages, Functions and Variables – Run First!<a class="headerlink" href="#packages-functions-and-variables-run-first" title="Permalink to this heading">#</a></h3>
<p>The following code-block contains the packages, functions and variables needed for the code found later in this notebook.  It must be run first.  Note that if you are running this on your personal computer, you should ensure that all packages needed are installed first (for example the <a class="reference external" href="https://numpy.org/">numpy</a>, <a class="reference external" href="https://scipy.org/">scipy</a>, and <a class="reference external" href="https://matplotlib.org/">matplotlib</a> packages must be installed on your computer along with others).  You can find a launcher link at the top to conveniently run this notebook in Google Colab.</p>
<p>The code below is hidden by default, but you are encouraged to expand it and study it.  The functions and constants will update as needed during the progression of the course, so you should note what new functions have been and added and study how they work.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span>
<span class="kn">import</span> <span class="nn">h5py</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>


<span class="c1">#--Physical Constants--</span>
<span class="n">hbar</span> <span class="o">=</span> <span class="mf">1.054e-34</span> <span class="c1">#normalized Planck constant [J*s]</span>
<span class="n">evcon</span> <span class="o">=</span> <span class="mf">1.602e-19</span> <span class="c1">#conversion factor, [J/eV]</span>
<span class="n">eta</span> <span class="o">=</span> <span class="mf">119.91699832</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="c1">#impedance of freespace [ohms]</span>
<span class="n">me</span> <span class="o">=</span> <span class="mf">9.10938188e-31</span> <span class="c1">#mass of electron [kg]</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">2.99792458e8</span> <span class="c1">#speed of light [m/s]</span>
<span class="n">e</span> <span class="o">=</span> <span class="mf">1.602e-19</span> <span class="c1">#electron charge [C]</span>

<span class="c1">#--Gaussian Pulse Function --</span>
<span class="k">def</span> <span class="nf">gaussian_pulse</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">,</span> <span class="n">wc</span><span class="p">,</span> <span class="n">phi_ce</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    [E, A] = gaussian_pulse(t, fwhm, wc, phi_ce)</span>

<span class="sd">    Function for generating a Gaussian pulse form with given intensity FWHM.</span>
<span class="sd">    Outputs electric field profile and intensity envelope, both normalized to</span>
<span class="sd">    peak of 1.  Units need to be self-consistent between t, fwhm, and wc.</span>

<span class="sd">    Inputs:</span>
<span class="sd">    -----------</span>
<span class="sd">      t --&gt; time </span>
<span class="sd">      fwhm --&gt; full width at half max of the intensity envelope</span>
<span class="sd">      wc --&gt; central frequency (rad/unit time)</span>
<span class="sd">      phi_ce --&gt; carrier envelope phase offset (rad)</span>

<span class="sd">    Outputs:</span>
<span class="sd">    -------------</span>
<span class="sd">      pulse[&#39;E&#39;] --&gt; Electric field profile (peak of 1)</span>
<span class="sd">      pulse[&#39;A&#39;] --&gt; Intensity envelope (peak of 1)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="c1">#Now determine constant for gaussian envelope from fwhm:</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="n">fwhm</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)));</span>

    <span class="c1">#Finally, define the pulse:</span>
    <span class="n">E_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">tau</span><span class="o">**</span><span class="mi">2</span><span class="p">));</span>
    
    <span class="n">pulse</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">pulse</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E_envelope</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">wc</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phi_ce</span><span class="p">);</span>

    <span class="n">pulse</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E_envelope</span><span class="o">**</span><span class="mi">2</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="n">pulse</span>

<span class="c1">#Calculate index based on Sellmeier coefficients</span>
<span class="c1"># -- Assumes wavelength in microns</span>
<span class="k">def</span> <span class="nf">n_sell</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate index based on Sellmeier coefficients.</span>
<span class="sd">    </span>
<span class="sd">    Assumes wavelength y in microns.</span>
<span class="sd">    </span>
<span class="sd">    B and C should be vectors with equal number of coefficients.</span>
<span class="sd">    </span>
<span class="sd">    Based on forumlation here: https://en.wikipedia.org/wiki/Sellmeier_equation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">n2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    
    <span class="c1">#We are only concerned with wavelengths &gt; 0!</span>
    <span class="n">y_valid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">)):</span>
        
        <span class="n">n2</span><span class="p">[</span><span class="n">y_valid</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">n2</span><span class="p">[</span><span class="n">y_valid</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">B</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">y_valid</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">y_valid</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">C</span><span class="p">[</span><span class="n">m</span><span class="p">])</span>
        
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">n2</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">n</span>


<span class="k">def</span> <span class="nf">split_step</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">beta2</span><span class="p">,</span> <span class="n">beta3</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function carries out the split step procedure </span>
<span class="sd">    to calculate a pulse spectra propagating through the NLSE. The</span>
<span class="sd">    split-step implementation here is not optimized in any way. (I&#39;d say</span>
<span class="sd">    that it&#39;s relatively inefficient.) This function does not use a</span>
<span class="sd">    normalized NLSE. (4-21-20).</span>
<span class="sd">    </span>
<span class="sd">    INPUTS: </span>
<span class="sd">        A0      sqrt(W):    input pulse</span>
<span class="sd">        z       mm:         spatial grid to propagate over (uniformly sampled)</span>
<span class="sd">        f       PHz:        frequency span for FFTs (defined by t)</span>
<span class="sd">        dt      fs:         temporal spacing </span>
<span class="sd">        beta2   fs^2/mm:    GVD</span>
<span class="sd">        beta3   fs^3/mm:    TOD</span>
<span class="sd">        gamma   1/(W*mm):   nonlinear coeff.</span>
<span class="sd"> </span>
<span class="sd">    OUTPUTS:</span>
<span class="sd">        A   time signal out</span>
<span class="sd">        A_f frequency signal out</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Nz</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span>
    
    <span class="c1">#z should be uniformly sampled</span>
    <span class="n">dz</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># initialize </span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span> <span class="p">(</span><span class="n">Nz</span><span class="p">,</span> <span class="n">A0</span><span class="o">.</span><span class="n">size</span><span class="p">))</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span>
    <span class="n">A_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span> <span class="p">(</span><span class="n">Nz</span><span class="p">,</span> <span class="n">A0</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">A0</span>
    <span class="n">A_f</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">dt</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">A0</span><span class="p">);</span>

    <span class="c1">#calculate all the traces and spectra</span>
    <span class="k">for</span> <span class="n">co</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Nz</span><span class="p">):</span>
        <span class="c1">#spectrum calculation</span>
        <span class="n">Atemp_f</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">beta2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">dz</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="mi">12</span><span class="o">*</span><span class="n">beta3</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">dz</span><span class="p">)</span><span class="o">*</span>\
        <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">co</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">dz</span><span class="p">)</span><span class="o">*</span>\
        <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">beta2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">dz</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="mi">12</span><span class="o">*</span><span class="n">beta3</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">dz</span><span class="p">)</span><span class="o">*</span>\
        <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span> <span class="n">A</span><span class="p">[</span><span class="n">co</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span>

        <span class="c1">#assignments</span>
        <span class="n">A_f</span><span class="p">[</span><span class="n">co</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Atemp_f</span><span class="p">;</span>
        <span class="n">A</span><span class="p">[</span><span class="n">co</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">Atemp_f</span><span class="p">);</span>
    
    
    <span class="k">return</span> <span class="n">A</span><span class="p">,</span> <span class="n">A_f</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="self-phase-modulation">
<h3>Self-Phase Modulation<a class="headerlink" href="#self-phase-modulation" title="Permalink to this heading">#</a></h3>
<p>In this section we study important characteristics of self-phase modulation.  We go a bit beyond the lectures to discuss more details about soliton formation, and the impact of higher-order dispersion on supercontinuum generation in more realistic systems.</p>
<p>Note that a new function has been added in teh headers section: <code class="docutils literal notranslate"><span class="pre">split_step(...)</span></code>.  See the function definition for reference.  This will be used throughout the following sections to simulation the effects of self-phase modulation on the propagating pulse.</p>
<section id="soliton-formation">
<h4>Soliton Formation<a class="headerlink" href="#soliton-formation" title="Permalink to this heading">#</a></h4>
<p>We study how solitons form even when the initial pulse is not itself a soliton.  We do this first for a simple Gaussian and then for a top-hat-like pulse.</p>
<section id="starting-from-an-initial-gaussian-pulse">
<h5>Starting from an initial Gaussian pulse<a class="headerlink" href="#starting-from-an-initial-gaussian-pulse" title="Permalink to this heading">#</a></h5>
<p>We need to start by defining our pulse and its envelope. We can use the pre-defined function in the headers block above for that.</p>
<p>In the interactive script below, start by using the defaults and then come back to play with different pulse shapes.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -- Pulse Settings -- </span>
<span class="n">yc</span> <span class="o">=</span> <span class="mf">1.55</span> <span class="c1"># central wavelength in micrometers</span>
<span class="n">phi_ce</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1">#this one is in femtoseconds</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1">#We now define the plotting within a function.</span>
<span class="c1">#We do this as we are going to use interactive widgets to let us dynamically</span>
<span class="c1">#change parameters and replot.  This can be very useful for visualization</span>
<span class="c1">#and study.  </span>


<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">fwhm</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">phi_ce</span><span class="p">):</span>

    <span class="c1"># -- Plotting -- </span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    
    <span class="c1"># -- Calculations  -- </span>
    <span class="n">t_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">fwhm</span><span class="o">*</span><span class="mi">50</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">*</span><span class="mi">50</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="c1">#time in fs</span>
    
    <span class="n">wc</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="mf">1e-15</span><span class="o">/</span><span class="p">(</span><span class="n">yc</span><span class="o">*</span><span class="mf">1e-6</span><span class="p">)</span> <span class="c1"># angular frequency in rad/fs</span>
    
    <span class="n">pulse</span> <span class="o">=</span> <span class="n">gaussian_pulse</span><span class="p">(</span><span class="n">t_ax</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">,</span> <span class="n">wc</span><span class="p">,</span> <span class="n">phi_ce</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="c1">#pulse information</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pulse</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">])</span> <span class="c1">#code provides intensity envelope, we need to convert to field envelope...</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">pulse</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="c1">#Fields for reference</span>



    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ax</span><span class="p">,</span> <span class="n">pulse</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E-Field&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ax</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pulse</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Envelope&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">fwhm</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">fwhm</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (fs)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Field/Envelope (Normalized)&#39;</span><span class="p">)</span>
    

    <span class="k">return</span> <span class="n">wc</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">,</span> <span class="n">t_ax</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">E</span>

<span class="n">pulse_set</span> <span class="o">=</span> <span class="n">ipywidgets</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> 
                    <span class="n">fwhm</span><span class="o">=</span><span class="n">ipywidgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">fwhm</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;FWHM (fs)&#39;</span><span class="p">),</span>
                    <span class="n">yc</span><span class="o">=</span><span class="n">ipywidgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;$\lambda_c$ ($\mu$m)&#39;</span><span class="p">),</span>
                    <span class="n">phi_ce</span><span class="o">=</span><span class="n">ipywidgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">phi_ce</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;$\phi_{\mathrm</span><span class="si">{ce}</span><span class="s1">}$ ($\pi$ rad)&#39;</span><span class="p">))</span>


<span class="n">display</span><span class="p">(</span><span class="n">pulse_set</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e82e12decf834528bcd4b33b866a9295", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>Now use the <code class="docutils literal notranslate"><span class="pre">split_step</span></code> function to propagate this pulse along a nonlinear medium.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Retrieve values after setting pulse above</span>
<span class="n">wc</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">,</span> <span class="n">t_ax</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">E</span> <span class="o">=</span> <span class="n">pulse_set</span><span class="o">.</span><span class="n">result</span>

<span class="c1">#Take the FT of the envelope</span>
<span class="n">A_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1">#Define the frequency axis</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">w</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">beta2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">40.0</span> <span class="c1">#negative GDD for soliton formation</span>
<span class="n">beta3</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#TOD -- set to 0.0 for now</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.07</span> <span class="c1">#Should be balanced with gamma</span>
<span class="n">A_out</span><span class="p">,</span> <span class="n">A_out_f</span> <span class="o">=</span> <span class="n">split_step</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">beta2</span><span class="p">,</span> <span class="n">beta3</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now plot the output at various points along the propagation length.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the result</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">25</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">500</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">wc</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">wc</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Angular Frequency (rad/fs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Intensity&#39;)
</pre></div>
</div>
<img alt="_images/d8e68f50f859b8fbdf5e704aa8ada8113f16512e21d9ea2f0d032e9ef889497b.png" src="_images/d8e68f50f859b8fbdf5e704aa8ada8113f16512e21d9ea2f0d032e9ef889497b.png" />
</div>
</div>
<p>Note that the basic spectrum quickly changes and starts to converge to a similar shape after that.  There are higher frequency ripples that continue to get tighter and go away as the pulse propagates.  In time, however, the pulses are quite smooth and quickly take on the <code class="docutils literal notranslate"><span class="pre">sech</span></code>-shaped formation that is the hallmark of a soliton.</p>
<p>The following script plots the time-domain behavior at the points chosen above.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the result</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="c1">#Calculate tau given final parameters:</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">beta2</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]))</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">gamma</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ax</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ax</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">25</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="c1"># # plt.plot(t_ax, np.abs(A_out[50, :].squeeze()/np.max(np.abs(A_out[50, :].squeeze())))**2)</span>
<span class="c1"># # plt.plot(t_ax, np.abs(A_out[250, :].squeeze()/np.max(np.abs(A_out[250, :].squeeze())))**2)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ax</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">500</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ax</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">t_ax</span><span class="o">/</span><span class="n">tau</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sech&#39;</span><span class="p">)</span>


<span class="c1">#plt.xlim(wc - 0.1, wc + 0.1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (fs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Intensity&#39;)
</pre></div>
</div>
<img alt="_images/a59b29b1a5b04f9f0dae08290b4134e275052da5377c28f4811045b6e6fd7417.png" src="_images/a59b29b1a5b04f9f0dae08290b4134e275052da5377c28f4811045b6e6fd7417.png" />
</div>
</div>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">t_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out</span><span class="p">),</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (fs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Distance (mm)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Distance (mm)&#39;)
</pre></div>
</div>
<img alt="_images/0f2852d48e251b69cd96d3d4b765f624d0ca7751d469c751074c61c402eeb983.png" src="_images/0f2852d48e251b69cd96d3d4b765f624d0ca7751d469c751074c61c402eeb983.png" />
</div>
</div>
</section>
<section id="starting-from-a-flat-top-pulse">
<h5>Starting from a “flat-top” pulse<a class="headerlink" href="#starting-from-a-flat-top-pulse" title="Permalink to this heading">#</a></h5>
<p>We can use a tukey window to create a flat-topped pulse as our input, keeping all other settings the same.</p>
<p>This starts to get tricky as with very fast edges you have higher frequency components which can create some numerical issues.  We avoid this by smoothing out thedges using a tukey window.</p>
<p>Interestingly, despite the very different initial pulse shape, the frequency spectrum rapidly changes to one similar to the Gaussian input and the time-domain pulse takes on the same <code class="docutils literal notranslate"><span class="pre">sech</span></code> shape as with the Gaussian case (superimposed below again for comparison).</p>
<p>This is a main reason soliton propagation is so attractive.  Despite widely varying input conditions, the system naturally “cleans” the input resulting in a well-defined and repeatable pulse shape each time.</p>
<p>Many oscillators leverage this principal to start from a “seed” transient which eventually washes out to a repeatable soliton solution.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Retrieve values after setting pulse above</span>
<span class="n">wc</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">,</span> <span class="n">t_ax</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">E</span> <span class="o">=</span> <span class="n">pulse_set</span><span class="o">.</span><span class="n">result</span>

<span class="n">A_sq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">t_ax</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">A_sq</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t_ax</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">tukey</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t_ax</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>

<span class="c1">#Take the FT of the envelope</span>
<span class="n">A_sq_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">A_sq</span><span class="p">)</span>

<span class="c1">#Define the frequency axis</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">w</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">beta2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">40.0</span> <span class="c1">#negative GDD for soliton formation</span>
<span class="n">beta3</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#TOD -- set to 0.0 for now</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1">#Should be balanced with gamma</span>
<span class="n">A_sq_out</span><span class="p">,</span> <span class="n">A_sq_out_f</span> <span class="o">=</span> <span class="n">split_step</span><span class="p">(</span><span class="n">A_sq</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">beta2</span><span class="p">,</span> <span class="n">beta3</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the result</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_sq_out_f</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_sq_out_f</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">25</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_sq_out_f</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">500</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_sq_out_f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">wc</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">wc</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Angular Frequency (rad/fs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity (arb. units)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Intensity (arb. units)&#39;)
</pre></div>
</div>
<img alt="_images/3958920955b81d9db33b92f3519406a21a737ab78f9b1dc747d292fd2a909663.png" src="_images/3958920955b81d9db33b92f3519406a21a737ab78f9b1dc747d292fd2a909663.png" />
</div>
</div>
<p>Again, we then take a look at the pulse at select points in the time-domain.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the result</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="c1">#Calculate tau given final parameters:</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">beta2</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_sq_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]))</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">gamma</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ax</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_sq_out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ax</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_sq_out</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_sq_out</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">25</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ax</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_sq_out</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_sq_out</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">500</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ax</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_sq_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_sq_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">t_ax</span><span class="o">/</span><span class="n">tau</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sech&#39;</span><span class="p">)</span>


<span class="c1">#plt.xlim(wc - 0.1, wc + 0.1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (fs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity (arb. units)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Intensity (arb. units)&#39;)
</pre></div>
</div>
<img alt="_images/34fc0a9b64e74c3a3d08288e28db7a5054a9146a2d540d450e55d53bd3b74f0b.png" src="_images/34fc0a9b64e74c3a3d08288e28db7a5054a9146a2d540d450e55d53bd3b74f0b.png" />
</div>
</div>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">t_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_sq_out</span><span class="p">),</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (fs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Distance (mm)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Distance (mm)&#39;)
</pre></div>
</div>
<img alt="_images/ccf5ae5d51ce084de9954a7b467cf1a98e7c7c63129007c317fff12b9b5a3337.png" src="_images/ccf5ae5d51ce084de9954a7b467cf1a98e7c7c63129007c317fff12b9b5a3337.png" />
</div>
</div>
</section>
</section>
</section>
<section id="influence-of-dispersion-on-supercontinuum-generation">
<h3>Influence of Dispersion on Supercontinuum Generation<a class="headerlink" href="#influence-of-dispersion-on-supercontinuum-generation" title="Permalink to this heading">#</a></h3>
<p>Let’s start again with our initial Gaussian pulse from before for the following demonstrations where we study supercontinuum generation for various levels of dispersion.</p>
<section id="zero-dispersion">
<h4>Zero Dispersion<a class="headerlink" href="#zero-dispersion" title="Permalink to this heading">#</a></h4>
<p>If <span class="math notranslate nohighlight">\(k'' \geq 0\)</span>, supercontinuum generation results as a funciton of propagation in the presence of <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>. The case of zero dispersion was discussed in lecture and we show an example again below.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Retrieve values after setting pulse above</span>
<span class="n">wc</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">,</span> <span class="n">t_ax</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">E</span> <span class="o">=</span> <span class="n">pulse_set</span><span class="o">.</span><span class="n">result</span>

<span class="c1">#Take the FT of the envelope</span>
<span class="n">A_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1">#Define the frequency axis</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">w</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="c1"># beta2 = 2000</span>
<span class="c1"># beta3 = -5000</span>
<span class="n">beta2</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">beta3</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">gamma</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="n">A_out</span><span class="p">,</span> <span class="n">A_out_f</span> <span class="o">=</span> <span class="n">split_step</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">beta2</span><span class="p">,</span> <span class="n">beta3</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the result</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mf">5.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">500</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mf">5.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mf">5.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">wc</span> <span class="o">-</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">wc</span> <span class="o">+</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Angular Frequency (rad/fs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity (arb. units)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Intensity (arb. units)&#39;)
</pre></div>
</div>
<img alt="_images/5371e2a0b55327eaab123c607dd73085e2cd2013ffa48e47053bd27c0a76dbdc.png" src="_images/5371e2a0b55327eaab123c607dd73085e2cd2013ffa48e47053bd27c0a76dbdc.png" />
</div>
</div>
<p>There is equal broadening on either side as the system is symmetric in frequency.  As noted, this can be used to shorten the input pulse through this spectral broadening.</p>
</section>
<section id="postive-second-order-dispersion">
<h4>Postive Second-Order Dispersion<a class="headerlink" href="#postive-second-order-dispersion" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Retrieve values after setting pulse above</span>
<span class="n">wc</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">,</span> <span class="n">t_ax</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">E</span> <span class="o">=</span> <span class="n">pulse_set</span><span class="o">.</span><span class="n">result</span>

<span class="c1">#Take the FT of the envelope</span>
<span class="n">A_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1">#Define the frequency axis</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">w</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">beta2</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">beta3</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">gamma</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="n">A_out</span><span class="p">,</span> <span class="n">A_out_f</span> <span class="o">=</span> <span class="n">split_step</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">beta2</span><span class="p">,</span> <span class="n">beta3</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the result</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mf">5.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">500</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mf">5.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mf">5.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">wc</span> <span class="o">-</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">wc</span> <span class="o">+</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Angular Frequency (rad/fs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity (arb. units)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Intensity (arb. units)&#39;)
</pre></div>
</div>
<img alt="_images/920bdaf0c42d4559d0233ccc7ff0b80f0663ba8946044ade4da3a0a1f024e8de.png" src="_images/920bdaf0c42d4559d0233ccc7ff0b80f0663ba8946044ade4da3a0a1f024e8de.png" />
</div>
</div>
<p>Second order dispersion quickly broadens the pulse in time preventing subsequent broadening.  Thus, to shorten a pulse, we need to operate around points with little second order dispersion.</p>
<p>These points can be engineered via material choice and waveguide geometry.  Remember, we often perform this self-phase modulation within a waveguide, which carries its own dispersion that can be used to balance that of the chosen waveguide materials.  Thus, we want to design our nonlinear waveguides for pulse broadening to have regions of zero dispersion (i.e. <span class="math notranslate nohighlight">\(k'' = 0\)</span>) that lie within the pump bandwidth.  You will often see reference to “zero-dipsersion wavelength” within papers that discuss supercontinuum generation in fibers and waveguides.</p>
<p>Realistically, however, this does not mean that higher-order dispersion does not still exist.  Thus, we need to consider the case when <span class="math notranslate nohighlight">\(k'' = 0\)</span> but <span class="math notranslate nohighlight">\(k''' \neq 0\)</span>.</p>
</section>
<section id="considering-k-neq-0-when-k-0">
<h4>Considering <span class="math notranslate nohighlight">\(k''' \neq 0\)</span> when <span class="math notranslate nohighlight">\(k'' = 0\)</span><a class="headerlink" href="#considering-k-neq-0-when-k-0" title="Permalink to this heading">#</a></h4>
<p>Note the split-step solver above  takes the input <code class="docutils literal notranslate"><span class="pre">beta3</span></code> for the third-order dispersion, related to the third order derivative of <span class="math notranslate nohighlight">\(k\)</span> with respect to <span class="math notranslate nohighlight">\(\omega\)</span>, <span class="math notranslate nohighlight">\(k'''\)</span>.  If <span class="math notranslate nohighlight">\(k''' &gt; 0\)</span> and <span class="math notranslate nohighlight">\(k'' = 0\)</span> at the central frequency of the pump pulse, then the spectra generated above the central frequency sees normal dispersion and broaden continuously (dispersive-wave generation), while regions less than the central frequency see negative dispersion and are soliton-like and see less broadening.  In other words, after splitting, each half in frequency space behaves like the soliton and dispersive-wave generation examples we have already explored above.</p>
<p>To see why this is the case, remember that <span class="math notranslate nohighlight">\(k''(\omega) \approx \omega k'''\)</span> according to the Taylor expansion.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Retrieve values after setting pulse above</span>
<span class="n">wc</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">,</span> <span class="n">t_ax</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">E</span> <span class="o">=</span> <span class="n">pulse_set</span><span class="o">.</span><span class="n">result</span>

<span class="c1">#Take the FT of the envelope</span>
<span class="n">A_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1">#Define the frequency axis</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">w</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="c1"># beta2 = 2000</span>
<span class="c1"># beta3 = -5000</span>
<span class="n">beta2</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">beta3</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">A_out</span><span class="p">,</span> <span class="n">A_out_f</span> <span class="o">=</span> <span class="n">split_step</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">beta2</span><span class="p">,</span> <span class="n">beta3</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the result</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mf">5.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">500</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mf">5.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mf">5.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">wc</span> <span class="o">-</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">wc</span> <span class="o">+</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Angular Frequency (rad/fs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity (arb. units)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Intensity (arb. units)&#39;)
</pre></div>
</div>
<img alt="_images/00f221acfe1c915aeeac29d791ad73377cb84a2a1d5f31f2affd575d31a37fad.png" src="_images/00f221acfe1c915aeeac29d791ad73377cb84a2a1d5f31f2affd575d31a37fad.png" />
</div>
</div>
<p>This is an important case to study as most realistic supercontinuum generation happens under similar conditions, especially within optical fibers (for instance photonic crystal fibers).</p>
<p>When considering compression, we can take a look at the group delay <span class="math notranslate nohighlight">\(d\phi/d\omega\)</span> of the output pulse:</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the result</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">dw</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="n">dw</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">500</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">wc</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">A_out_f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="n">dw</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mi">5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">350</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Angular Frequency (rad/fs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Group Delay (fs)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Group Delay (fs)&#39;)
</pre></div>
</div>
<img alt="_images/7497a95beef8279e86fa0900682b6380bc278c406d308a222bb7d4ca444a9855.png" src="_images/7497a95beef8279e86fa0900682b6380bc278c406d308a222bb7d4ca444a9855.png" />
</div>
</div>
<p>Note that the higher frequencies (dispersive wave) exhibit a fairly smooth phase and are fairly easy to compress.  See <a class="reference external" href="https://drive.google.com/file/d/1dqaGewRxMqnXj59H28aOy4OHbwQjsz0M/view?usp=sharing">Sell et al.</a> for a very thorough study of similar supercontinuum generation in erbium-dobed fibers, which at the time was used to create some of the shortest pulses generated within a compact fiber-based system at megahertz repetition rates.  To achieve this result, the higher frequency components with smooth phase were isolated via filtering and compressed using a prism pair.</p>
<p><strong>Question:</strong> Why were the lower-frequencies not included?</p>
<p>For another reference into the impressive advances in waveguide-based light sources, I would also recommend <a class="reference external" href="https://drive.google.com/file/d/1olfUjXnzcvY54fsVEOZNgaGFGhZ4gI5-/view?usp=sharing">Carlson et. al.</a> where they are able to use nonlinearities and electro-optics for the generation and compression of few-cycle pulses starting from a continuous-wave source.</p>
<p><strong>Suggested Exercise:</strong> Numerically filter out the higher frequency components of the broadened pulse calculated above.  How short can you compress it by adding in compensating amounts of second-order dispersion?</p>
</section>
</section>
<section id="chi-3-in-sub-wavelength-structures-all-optical-switching">
<h3><span class="math notranslate nohighlight">\(\chi^{(3)}\)</span> in sub-wavelength structures: all optical switching<a class="headerlink" href="#chi-3-in-sub-wavelength-structures-all-optical-switching" title="Permalink to this heading">#</a></h3>
<p>There are two exciting and emerging trends in photonics: (1) it is becoming easier to fabricate and design sub-wavelength photonic structures from various media exhibing high nonlinearity; (2) waveguide-based sources of ultrafast light are improving at a dramatic pace.  We already know that the increased peak intensities of ultrafast light increase the nonlinear interaction with media, and this can be increased even further through the use of sub-wavelength structuring for geometric and resonant field enhancement.</p>
<p>One application is all optical switching.  Since the nonlinear interaction from <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span> locally influences refractive index, light can be used to alter how a signal is routed through a system.  Let’s revisit the <a class="reference external" href="https://drive.google.com/file/d/1qFtRer1n6lHchWxNbD47yfZcs41NhIrJ/view?usp=sharing">Fabry-Perot resonator</a>.  We already know that when the optical path length of the resonator is on the order of one wavelength (<span class="math notranslate nohighlight">\(L = \lambda_{\text{mat}} = 2\pi/(nk_0)\)</span>, where we assume the resonator is filled with material having refractive index <span class="math notranslate nohighlight">\(n\)</span>) transmission peaks.  However, when this optical length increases by just a quarter of a wavelength to <span class="math notranslate nohighlight">\(1.25\lambda_\text{mat}\)</span> transmission is at a minimum resulting in high reflection.  Thus, one can imagine that if the cavity is filled with a material with large enough <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span> and driven by a short pulse with large-enough peak intensity, one could achieve an effect where the driving pulse could switch the behavior of the cavity in real time from “on” (high transmission) to “off” (low transmission).  This is because the intensity-dependent index contribution adds to the index, thus increasing <span class="math notranslate nohighlight">\(L/\lambda_\text{mat} = L(n + \Delta n)k_0/(2\pi)\)</span>.</p>
<p>To examine this further, we can perform full electromagnetic simulation using <a class="reference external" href="https://meep.readthedocs.io/en/latest/">MEEP</a> (a seriously amazing open-source electromagnetic solver that you should look into if interested) with the inclusion of <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span> nonlinearity.  We create a Fabry-Perot cavity by simply using a one-wavelength slab of high-index material (<span class="math notranslate nohighlight">\(\epsilon = 12\)</span>, similar to silicon). We can then examine the transmitted field from a pulse: (1) without any structure; (2) with the structure, but with <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span> turned off; and (3) with the structure but with <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span> such that the effective path length increases minimizing transmission.</p>
<p>If interested, I have included the python MEEP code in the drive folder <a class="reference external" href="https://drive.google.com/file/d/1SNQAst6_XwYoW_JIsy0ojCCy8Hn-RO3i/view?usp=sharing">here</a>.</p>
<p>First, we load the data from the simulation.</p>
<p><strong>Note About Loading The h5 Data Files:</strong>  The data files from the electromagnetic simulation are stored in the shared drive space.  They are in h5 format.  If running this notebook on your computer, you must download them and put them in the local directory of the notebook.  If on Google Colaboratory, you must load them into the notebook space:</p>
<ol class="arabic simple">
<li><p>Download the h5 files from the <a class="reference external" href="https://drive.google.com/drive/folders/1ZRpfZWBphLhFikFmgQDwWK1fccPsAe89?usp=sharing">Recitation 4 drive folder</a></p></li>
<li><p>Click the file icon in the left pane of Google Colaboratory</p></li>
<li><p>Upload the h5 files.  These will be deleted at the end of the session so you must do it each time you load this notebook.</p></li>
</ol>
<p><strong>Note About MEEP Simulations</strong> I provide the MEEP simulation python script <a class="reference external" href="https://drive.google.com/file/d/1SNQAst6_XwYoW_JIsy0ojCCy8Hn-RO3i/view?usp=sharing">here in the drive</a> for those interested.  Consult the <a class="reference external" href="https://meep.readthedocs.io/en/latest/">documentation for MEEP</a> for installation instructions.  If there is interest, I could demonstrate this in a recitation video.  Send me a message to let me know.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;data/supercontinuum-Ey-slab-w-chi3-75.0-lambda-0.0-HR.h5&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ey_no_cavity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ey&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;data/supercontinuum-Ey-slab-w-chi3-00.0-lambda-1.0-HR.h5&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ey_cavity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ey&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;data/supercontinuum-Ey-slab-w-chi3-75.0-lambda-1.0-HR.h5&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ey_cavity_chi3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ey&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The simulation is a 2D simulation in <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.  It has a plane-wave source at the left-most boundary that propagates from left to right and polarized in <span class="math notranslate nohighlight">\(y\)</span>.  In the middle is a vertical slab of the material with <span class="math notranslate nohighlight">\(\epsilon = 12\)</span> whos thickness was chosen to be such that <span class="math notranslate nohighlight">\(\lambda_\text{mat} = 1.55\)</span> <span class="math notranslate nohighlight">\(\mu\)</span>m, the wavelength of the plane wave source.</p>
<p>Below we plot the output fields across the entire simulation region at one point in time for visualization.  We compare the two cases of (2) the structure without <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>, and (3) the structure with <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>.  You can see the wavelength tightening near the slab region in the center, the development of higher frequencies within the slab when <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span> is turned on.  The color axis has been saturated for clarity (why you see the “glowing” source on the left). The dashed lines show the outline of the material slab at the center of the simulation cell.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">fcen</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">1.55</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">slab_width</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">fcen</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span>

<span class="c1">#Size of the cell in x and y</span>
<span class="n">sx</span><span class="o">=</span><span class="n">slab_width</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="n">sy</span><span class="o">=</span><span class="mf">1.4</span>

<span class="c1">#Extent of region to plot in microns</span>
<span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">sx</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">sx</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">sy</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">sy</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>

<span class="n">ax_cavity</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cavity</span> <span class="o">=</span> <span class="n">ax_cavity</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ey_cavity</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">199</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> 
                          <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">)</span>
<span class="n">ax_cavity</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cavity&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cavity</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_cavity</span><span class="p">)</span>
<span class="n">cavity</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">ax_cavity</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">slab_width</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> 
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax_cavity</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">slab_width</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> 
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax_cavity</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x ($\mu$m)&#39;</span><span class="p">)</span>
<span class="n">ax_cavity</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y ($\mu$m)&#39;</span><span class="p">)</span>

<span class="n">ax_cavity_chi3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">cavity_chi3</span> <span class="o">=</span> <span class="n">ax_cavity_chi3</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ey_cavity_chi3</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">201</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span>
                                    <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">)</span>
<span class="n">ax_cavity_chi3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cavity w/ Chi3&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cavity_chi3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_cavity_chi3</span><span class="p">)</span>
<span class="n">cavity_chi3</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">ax_cavity_chi3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">slab_width</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> 
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax_cavity_chi3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">slab_width</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> 
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax_cavity_chi3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x ($\mu$m)&#39;</span><span class="p">)</span>
<span class="n">ax_cavity_chi3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y ($\mu$m)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;y ($\\mu$m)&#39;)
</pre></div>
</div>
<img alt="_images/ff548c38a01c04b20e30403150cfe3d3c2fa3c075dbf4c49b2052b47ee7b1b65.png" src="_images/ff548c38a01c04b20e30403150cfe3d3c2fa3c075dbf4c49b2052b47ee7b1b65.png" />
</div>
</div>
<p>Next, we extract only the fields near the end of the cell on the right at the center – these will be the “output” fields that transmit through the structure.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_sample_rate</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">fcen</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">1.55</span>
<span class="n">df</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="mf">1e-6</span><span class="o">*</span><span class="mf">1e15</span><span class="o">/</span><span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">fcen</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">df</span><span class="p">)</span><span class="o">/</span><span class="n">time_sample_rate</span>

<span class="n">t_no_cavity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ey_no_cavity</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="n">dt</span>
<span class="n">t_cavity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ey_cavity</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="n">dt</span>
<span class="n">t_cavity_chi3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ey_cavity_chi3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="n">dt</span>

<span class="n">ey_no_cavity_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ey_no_cavity</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mi">75</span><span class="p">),</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ey_cavity_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ey_cavity</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mi">75</span><span class="p">),</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ey_cavity_chi3_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ey_cavity_chi3</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mi">75</span><span class="p">),</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we verify our design by first showing that the transmitted energy for case (1) and (2) are roughly equal – that is we have peak transmission wihtout any <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Take the FT of the envelope</span>
<span class="n">N_samples</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">ey_no_cavity_out_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">ey_no_cavity_out</span><span class="p">,</span> <span class="n">N_samples</span><span class="p">)</span>
<span class="n">ey_cavity_out_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">ey_cavity_out</span><span class="p">,</span> <span class="n">N_samples</span><span class="p">)</span>

<span class="n">w_out</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">N_samples</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w_out</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ey_no_cavity_out_f</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;No Cavity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w_out</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ey_cavity_out_f</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cavity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$\Omega$ (rad/fs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity (arb. units)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Intensity (arb. units)&#39;)
</pre></div>
</div>
<img alt="_images/84172c9e591dd8eb639377bf63f58bdbd39617b50dd044f96ab000867380708d.png" src="_images/84172c9e591dd8eb639377bf63f58bdbd39617b50dd044f96ab000867380708d.png" />
</div>
</div>
<p>As you can see, there is only a slight drop in transmission.  There could be other numerical reasons (such as the inclusion of the PML barriers and their interaction with the slab after it is introduced) that could result in the slight increase in absorption here.  Nonetheless, we can say it is negligible.</p>
<p>This sets our baseline and lets us know that we have almost full transmission with this cavity length without <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span> included.</p>
<p>Now we can compare the case of the cavity and the cavity wth <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Take the FT of the envelope</span>
<span class="n">ey_cavity_chi3_out_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">ey_cavity_chi3_out</span><span class="p">,</span> <span class="n">N_samples</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w_out</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ey_cavity_out_f</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cavity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w_out</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ey_cavity_chi3_out_f</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cavity w/ Chi3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$\Omega$ (rad/fs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity (arb. units)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Intensity (arb. units)&#39;)
</pre></div>
</div>
<img alt="_images/8ad360062efc812f55f01fa505ba26c6a88d88dc19f57c0209d2d4784a797fee.png" src="_images/8ad360062efc812f55f01fa505ba26c6a88d88dc19f57c0209d2d4784a797fee.png" />
</div>
</div>
<p>Note the significant drop in intensity.  The nonlinear interaction increased the effective path length quenching transmission.  There is no loss in the system, so this radiation is now reflected.</p>
<p>We can also see a bit of third-harmonic generation if we extend our frequency axis and plot on a log-scale.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Take the FT of the envelope</span>
<span class="n">ey_cavity_chi3_out_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">ey_cavity_chi3_out</span><span class="p">,</span> <span class="n">N_samples</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w_out</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ey_cavity_out_f</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cavity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w_out</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ey_cavity_chi3_out_f</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cavity w/ Chi3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">5e3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$\Omega$ (rad/fs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity (arb. units)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Intensity (arb. units)&#39;)
</pre></div>
</div>
<img alt="_images/94857344e9e01c7f607817ceb11f1a5473b5e95c95c1ba6bded2ebd2487e2123.png" src="_images/94857344e9e01c7f607817ceb11f1a5473b5e95c95c1ba6bded2ebd2487e2123.png" />
</div>
</div>
<p>It’s also instructive to look in the time-domain at the radiated output fields.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_cavity</span><span class="p">,</span> <span class="n">ey_cavity_out</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cavity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_cavity_chi3</span><span class="p">,</span> <span class="n">ey_cavity_chi3_out</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cavity w/ Chi3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (fs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Output Field (arb. units)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Output Field (arb. units)&#39;)
</pre></div>
</div>
<img alt="_images/32ceaf11222efc073528816125f326ba81d65f5bcda6502954096382af4cecfb.png" src="_images/32ceaf11222efc073528816125f326ba81d65f5bcda6502954096382af4cecfb.png" />
</div>
</div>
<p>Note on the leading edge, we can see that the radiation matches perfectly.  Then as intensity increases, you see the increase in the higher-frequency ripples.  These add to the main pulse, and accompany a phase shift of the fundamental for the case with <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>.  As expected, this phase-shift is roughly <span class="math notranslate nohighlight">\(\pi/4\)</span> reducing the transmission.  Of course, the leading radiation is not subject to this, only the trailing radiation, so the on-off ratio is not as good as would be predicted by a pure Fabry-Perot cavity.</p>
</section>
<section id="further-reading">
<h3>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this heading">#</a></h3>
<p>There is increasing literature on engineering such effects for optical switching and other applications, especially in combination with inverse-design techniques.  See for instance  <a class="reference external" href="https://drive.google.com/file/d/1seKbOsX4frPhD159ZwLY2PcBefstWhBT/view?usp=sharing">Hughes <em>et al.</em></a> where inverse design techniques are used to create sub-wavelength-structured switches that can route a pulsed signal in different directions depending on teh energy in the pulse.  While the structures are indeed more complex, this is conceptually quite similar to what we have discussed here.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="chapter-2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 2 – Pulse Interactions with Linear Media</p>
      </div>
    </a>
    <a class="right-next"
       href="chapter-4.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 4 – Mode-Locking</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#materials-and-notes">Materials and Notes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-and-computation">Simulation and Computation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#packages-functions-and-variables-run-first">Packages, Functions and Variables – Run First!</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#self-phase-modulation">Self-Phase Modulation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#soliton-formation">Soliton Formation</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-from-an-initial-gaussian-pulse">Starting from an initial Gaussian pulse</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-from-a-flat-top-pulse">Starting from a “flat-top” pulse</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#influence-of-dispersion-on-supercontinuum-generation">Influence of Dispersion on Supercontinuum Generation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zero-dispersion">Zero Dispersion</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#postive-second-order-dispersion">Postive Second-Order Dispersion</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#considering-k-neq-0-when-k-0">Considering <span class="math notranslate nohighlight">\(k''' \neq 0\)</span> when <span class="math notranslate nohighlight">\(k'' = 0\)</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-3-in-sub-wavelength-structures-all-optical-switching"><span class="math notranslate nohighlight">\(\chi^{(3)}\)</span> in sub-wavelength structures: all optical switching</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By P. Donald Keathley, William P. Putnam
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>